{"ast":null,"code":"import{doc,getDoc,setDoc,collection}from'firebase/firestore';import{db}from'./config';// –ö–æ–ª–ª–µ–∫—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫\nconst settingsCollection=collection(db,'settings');// –î–æ–∫—É–º–µ–Ω—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ Telegram\nconst telegramConfigDoc=doc(settingsCollection,'telegramConfig');// –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Telegram\nexport const getTelegramConfig=async()=>{try{const docSnap=await getDoc(telegramConfigDoc);if(docSnap.exists()){return docSnap.data();}else{// –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç\nconst defaultConfig={botToken:'7836895913:AAGbj_E6i3AqXi7Sh2bDxn8WI0LRE7hNGBo',channelId:'',enabled:false};await setDoc(telegramConfigDoc,defaultConfig);return defaultConfig;}}catch(error){console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Telegram:',error);throw error;}};// –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Telegram\nexport const updateTelegramConfig=async configData=>{try{await setDoc(telegramConfigDoc,configData);return configData;}catch(error){console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Telegram:',error);throw error;}};// –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram –∫–∞–Ω–∞–ª\nexport const sendTelegramMessage=async message=>{try{const config=await getTelegramConfig();if(!config.enabled||!config.botToken||!config.channelId){console.warn('Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞ –∏–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞');return false;}// –ò—Å–ø–æ–ª—å–∑—É–µ–º Telegram Bot API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è\nconst url=`https://api.telegram.org/bot${config.botToken}/sendMessage`;const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({chat_id:config.channelId,text:message,parse_mode:'HTML'})});const data=await response.json();if(!data.ok){throw new Error(`–û—à–∏–±–∫–∞ Telegram API: ${data.description}`);}return true;}catch(error){console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram:',error);throw error;}};// –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –ª—É—á—à–µ–º –ø—Ä–æ–º–æ—É—Ç–µ—Ä–µ\nexport const sendTopPromoterMessage=async promoter=>{if(!promoter)return false;const message=`\nüèÜ <b>–õ—É—á—à–∏–π –ø—Ä–æ–º–æ—É—Ç–µ—Ä –º–µ—Å—è—Ü–∞!</b> üèÜ\n\n–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º <b>${promoter.name}</b> —Å –ø–æ–±–µ–¥–æ–π!\n–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–Ω–µ—Å–µ–Ω–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤–æ–∫: <b>${promoter.leafletsCount}</b>\n–ù–∞–≥—Ä–∞–¥–∞: <b>${promoter.reward}</b>\n\nüéâ –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å! üéâ\n  `;return sendTelegramMessage(message);};/*\r\n–ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ù–ê–°–¢–†–û–ô–ö–ï TELEGRAM –ë–û–¢–ê:\r\n\r\n1. –ë–æ—Ç —É–∂–µ —Å–æ–∑–¥–∞–Ω, —Ç–æ–∫–µ–Ω: 7836895913:AAGbj_E6i3AqXi7Sh2bDxn8WI0LRE7hNGBo\r\n2. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞–Ω–∞–ª –≤ Telegram –∏ –¥–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞\r\n3. –ü–æ–ª—É—á–∏—Ç–µ ID –∫–∞–Ω–∞–ª–∞ (channelId) - –æ–±—ã—á–Ω–æ —ç—Ç–æ @–∏–º—è_–∫–∞–Ω–∞–ª–∞ –∏–ª–∏ —á–∏—Å–ª–æ–≤–æ–π ID\r\n4. –í–∫–ª—é—á–∏—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (enabled: true)\r\n5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É, –æ—Ç–ø—Ä–∞–≤–∏–≤ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ\r\n*/","map":{"version":3,"names":["doc","getDoc","setDoc","collection","db","settingsCollection","telegramConfigDoc","getTelegramConfig","docSnap","exists","data","defaultConfig","botToken","channelId","enabled","error","console","updateTelegramConfig","configData","sendTelegramMessage","message","config","warn","url","response","fetch","method","headers","body","JSON","stringify","chat_id","text","parse_mode","json","ok","Error","description","sendTopPromoterMessage","promoter","name","leafletsCount","reward"],"sources":["D:/–ø—Ä–æ–µ–∫—Ç—ã/Promo rating/src/firebase/telegramService.js"],"sourcesContent":["import { doc, getDoc, setDoc, collection } from 'firebase/firestore';\r\nimport { db } from './config';\r\n\r\n// –ö–æ–ª–ª–µ–∫—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫\r\nconst settingsCollection = collection(db, 'settings');\r\n// –î–æ–∫—É–º–µ–Ω—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ Telegram\r\nconst telegramConfigDoc = doc(settingsCollection, 'telegramConfig');\r\n\r\n// –ü–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Telegram\r\nexport const getTelegramConfig = async () => {\r\n  try {\r\n    const docSnap = await getDoc(telegramConfigDoc);\r\n    \r\n    if (docSnap.exists()) {\r\n      return docSnap.data();\r\n    } else {\r\n      // –°–æ–∑–¥–∞–µ–º –¥–æ–∫—É–º–µ–Ω—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç\r\n      const defaultConfig = {\r\n        botToken: '7836895913:AAGbj_E6i3AqXi7Sh2bDxn8WI0LRE7hNGBo',\r\n        channelId: '',\r\n        enabled: false\r\n      };\r\n      \r\n      await setDoc(telegramConfigDoc, defaultConfig);\r\n      return defaultConfig;\r\n    }\r\n  } catch (error) {\r\n    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Telegram:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Telegram\r\nexport const updateTelegramConfig = async (configData) => {\r\n  try {\r\n    await setDoc(telegramConfigDoc, configData);\r\n    return configData;\r\n  } catch (error) {\r\n    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Telegram:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ Telegram –∫–∞–Ω–∞–ª\r\nexport const sendTelegramMessage = async (message) => {\r\n  try {\r\n    const config = await getTelegramConfig();\r\n    \r\n    if (!config.enabled || !config.botToken || !config.channelId) {\r\n      console.warn('Telegram –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –æ—Ç–∫–ª—é—á–µ–Ω–∞ –∏–ª–∏ –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞');\r\n      return false;\r\n    }\r\n    \r\n    // –ò—Å–ø–æ–ª—å–∑—É–µ–º Telegram Bot API –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è\r\n    const url = `https://api.telegram.org/bot${config.botToken}/sendMessage`;\r\n    const response = await fetch(url, {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n      },\r\n      body: JSON.stringify({\r\n        chat_id: config.channelId,\r\n        text: message,\r\n        parse_mode: 'HTML'\r\n      }),\r\n    });\r\n    \r\n    const data = await response.json();\r\n    \r\n    if (!data.ok) {\r\n      throw new Error(`–û—à–∏–±–∫–∞ Telegram API: ${data.description}`);\r\n    }\r\n    \r\n    return true;\r\n  } catch (error) {\r\n    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ Telegram:', error);\r\n    throw error;\r\n  }\r\n};\r\n\r\n// –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–º –ª—É—á—à–µ–º –ø—Ä–æ–º–æ—É—Ç–µ—Ä–µ\r\nexport const sendTopPromoterMessage = async (promoter) => {\r\n  if (!promoter) return false;\r\n  \r\n  const message = `\r\nüèÜ <b>–õ—É—á—à–∏–π –ø—Ä–æ–º–æ—É—Ç–µ—Ä –º–µ—Å—è—Ü–∞!</b> üèÜ\r\n\r\n–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º <b>${promoter.name}</b> —Å –ø–æ–±–µ–¥–æ–π!\r\n–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑–Ω–µ—Å–µ–Ω–Ω—ã—Ö –ª–∏—Å—Ç–æ–≤–æ–∫: <b>${promoter.leafletsCount}</b>\r\n–ù–∞–≥—Ä–∞–¥–∞: <b>${promoter.reward}</b>\r\n\r\nüéâ –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å! üéâ\r\n  `;\r\n  \r\n  return sendTelegramMessage(message);\r\n};\r\n\r\n/*\r\n–ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ù–ê–°–¢–†–û–ô–ö–ï TELEGRAM –ë–û–¢–ê:\r\n\r\n1. –ë–æ—Ç —É–∂–µ —Å–æ–∑–¥–∞–Ω, —Ç–æ–∫–µ–Ω: 7836895913:AAGbj_E6i3AqXi7Sh2bDxn8WI0LRE7hNGBo\r\n2. –°–æ–∑–¥–∞–π—Ç–µ –∫–∞–Ω–∞–ª –≤ Telegram –∏ –¥–æ–±–∞–≤—å—Ç–µ –±–æ—Ç–∞ –∫–∞–∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞\r\n3. –ü–æ–ª—É—á–∏—Ç–µ ID –∫–∞–Ω–∞–ª–∞ (channelId) - –æ–±—ã—á–Ω–æ —ç—Ç–æ @–∏–º—è_–∫–∞–Ω–∞–ª–∞ –∏–ª–∏ —á–∏—Å–ª–æ–≤–æ–π ID\r\n4. –í–∫–ª—é—á–∏—Ç–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ (enabled: true)\r\n5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É, –æ—Ç–ø—Ä–∞–≤–∏–≤ —Ç–µ—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ\r\n*/ "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}